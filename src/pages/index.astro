---
import BaseLayout from "../layouts/BaseLayout.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
  .filter((p) => !p.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 6);
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION} lang="en" dir="ltr">
  <main class="container">
      <section class="hero">
        <h1>{SITE_TITLE}</h1>
        <p class="lead">{SITE_DESCRIPTION}</p>

        <div class="cta">
          <a class="button" href="/blog">Read the blog</a>
          <a class="link" href="/about">About</a>
        </div>
      </section>

      <section class="latest">
        <h2>Latest posts</h2>

        <ul class="post-list" dir="auto">
          {posts.map((post) => (
            <li class="post-item">
<a class="post-title" dir="auto" href={`/blog/${encodeURIComponent(post.id)}/`}>{post.data.title}</a>
                <time datetime={post.data.pubDate.toISOString()}>
                  {post.data.pubDate.toLocaleDateString("en-US", {
                    year: "numeric",
                    month: "short",
                    day: "2-digit",
                  })}
                </time>
                {post.data.description && <span class="dot">•</span>}
								{post.data.description && <span class="desc" dir="auto">{post.data.description}</span>}              </div>
            </li>
          ))}
        </ul>

        <p class="more">
          <a href="/blog">View all posts →</a>
        </p>
      </section>
    </main>

</BaseLayout>

<style>
  .container { max-width: 880px; margin: 0 auto; padding: 2.5rem 1.25rem; }
  .hero { padding: 1rem 0 2rem; }
  .lead { font-size: 1.15rem; line-height: 1.6; opacity: 0.85; max-width: 60ch; }
  .cta { margin-top: 1rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; }
  .button { display: inline-block; padding: 0.6rem 0.9rem; border-radius: 10px; border: 1px solid currentColor; text-decoration: none; }
  .link { text-decoration: none; opacity: 0.9; }
  .latest { border-top: 1px solid rgba(127,127,127,0.25); padding-top: 1.5rem; }
.post-list { list-style: none; padding: 0; margin: 1rem 0 0; display: grid; gap: 0.9rem;}

.post-item {
  text-align: start;
}

.post-title {
  display: block;
  font-weight: 650;
  text-decoration: none;
}
  .meta { margin-top: 0.25rem; font-size: 0.95rem; opacity: 0.8; display: flex; gap: 0.5rem; flex-wrap: wrap; }
  .dot { opacity: 0.6; }
  .more { margin-top: 1.25rem; }
</style>